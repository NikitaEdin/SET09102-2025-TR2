CREATE TABLE Roles (
    roleID INTEGER PRIMARY KEY AUTOINCREMENT,
    title TEXT NOT NULL,
    description TEXT,
    power INTEGER NOT NULL
);


CREATE TABLE Users (
    UserID INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL,
    name TEXT NOT NULL,
    password TEXT NOT NULL,
    roleID INTEGER,
    FOREIGN KEY (roleID) REFERENCES Roles(roleID) ON DELETE SET NULL
);

CREATE TABLE Sites (
    site_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT,
    latitude REAL,
    longitude REAL,
    elevation INTEGER,
    timezone TEXT,
    utc_offset INTEGER,
    type TEXT,
    zone TEXT,
    Agglomeration TEXT,
    Local_authority TEXT
);

CREATE TABLE Sensors (
    sensor_id INTEGER PRIMARY KEY AUTOINCREMENT,
    site_id INTEGER NOT NULL,
    sensor_type TEXT NOT NULL,
    sensor_url TEXT,
    deployment_date TEXT,
    sensor_operational BOOLEAN
   -- configID INTEGER, Circular Dependency with Sensor
   -- FOREIGN KEY (configID) REFERENCES Configuration(ConfigID) ON DELETE SET NULL
);

CREATE TABLE Configuration (
    config_id INTEGER PRIMARY KEY AUTOINCREMENT,
    sensor_id INTEGER NOT NULL,
    min_measurement REAL NOT NULL,
    max_measurement REAL NOT NULL,
    type TEXT NOT NULL,
   -- unit TEXT NOT NULL, This isn't needed 
    firmware REAL, -- assuming firmware is a file, stored as BLOB (REAL Datetype for now)
    FOREIGN KEY (sensor_id) REFERENCES Sensors(sensor_id) ON DELETE CASCADE
);

-- Nikita Metadata
CREATE TABLE IF NOT EXISTS Metadata (
    ID INTEGER PRIMARY KEY AUTOINCREMENT,
    category TEXT NOT NULL,
    quantity TEXT NOT NULL,
    symbol TEXT NOT NULL,
    unit TEXT NOT NULL,
    unit_description TEXT,
    measurement_freq TEXT,
    safe_level REAL,
    Sensor TEXT,
    reference_url TEXT,
    sensor_id INTEGER,
    FOREIGN KEY (sensor_id) REFERENCES Sensors(sensor_id)
);


-- Nikita Water Measurements Table
CREATE TABLE IF NOT EXISTS water_measurements (
    ID INTEGER PRIMARY KEY AUTOINCREMENT,
    datetime DATETIME NOT NULL,
    Nitrate REAL,
    Nitrite REAL,
    Phosphate REAL,
    EC REAL,
    metadata INTEGER,
    FOREIGN KEY (metadata) REFERENCES Metadata(ID)
);

-- Nikita Role Table
CREATE TABLE IF NOT EXISTS Roles (
    RoleID INTEGER PRIMARY KEY AUTOINCREMENT,
    Title TEXT NOT NULL,
    Description TEXT,
    Power INTEGER
);

-- Rachael Weather Measurements Table
CREATE TABLE IF NOT EXISTS weather_measurements (
    ID INTEGER PRIMARY KEY AUTOINCREMENT,
    date_time TEXT NOT NULL,
    temperature_2m REAL,
    relative_humidity_2m REAL,
    wind_speed_10m REAL,
    wind_direction_10m REAL,
    metadata INTEGER,
    FOREIGN KEY (metadata) REFERENCES Metadata(ID)
);


-- Rachael Air Measurements Table
CREATE TABLE IF NOT EXISTS air_measurements (
    ID INTEGER PRIMARY KEY AUTOINCREMENT,
    date_time TEXT NOT NULL,
    Nitrogen_Dioxide REAL,
    Sulphur_Dioxide REAL,
    PM2_5 REAL,
    PM10 REAL,
    metadata INTEGER,
    FOREIGN KEY (metadata) REFERENCES Metadata(ID)
);